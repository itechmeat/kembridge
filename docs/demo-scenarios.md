# KEMBridge — Сценарии демонстрации на демо-дне

Документ: пошаговые сценарии для живой демонстрации продукта. Каждая сцена — самостоятельный блок, их можно показывать как последовательно, так и избирательно. Сфокусировано на ценности для зрителя, без внутренних/скучных шагов.

Связанные артефакты:

- Продукт и видение: [docs/about.md](docs/about.md)
- План разработки: [plans/hackathon-development-plan.md](plans/hackathon-development-plan.md)
- Отчет о прогрессе: [plans/hackathon-development-report.md](plans/hackathon-development-report.md)
- База сценариев взята из E2E:
  - Bridge & Flow: e2e-tests/tests/bridge-integration.spec.js
  - Transaction Flow: e2e-tests/tests/transaction-flow.spec.js
  - Auth: e2e-tests/tests/wallet-authentication.spec.js
  - API Health & Nonce: e2e-tests/tests/api-integration.spec.js
  - Security & Risk: e2e-tests/tests/security-risk-testing.spec.js
  - AI Risk UI: e2e-tests/tests/ai-risk-display.spec.js

Подсказка: держать фронтенд запущенным (http://localhost:4100), сервисы здоровы.

---

## Сцена 0. Быстрый прогрев и «жива ли система»

Цель: за 60–90 секунд показать, что все сервисы живы и бэкенд отвечает.

Шаги:

1. Открыть терминал/инструмент для REST-запросов (или браузер):
   - GET {API_BASE}/health — показать JSON ответ Gateway (service: "kembridge-gateway-service", success: true).
   - (Опционально) Пробежать /api-docs/openapi.json в браузере для визуального подтверждения документации.
2. Короткий комментарий: «Все микросервисы в green состоянии, готовы к демонстрации».

Критерии успеха:

- Видно, что Gateway отвечает success: true.
- Отмечено, что это «реальные» (не мок) сервисные health-check’и.

---

## Сцена 1. Подключение кошелька (Web3 Auth)

Цель: показать простой вход в систему через кошелек и выпуск JWT (без деталей).

Шаги:

1. Открыть http://localhost:4100/ (Home).
2. Нажать «Ethereum Wallet» (или WalletConnect по выбору).
3. Подтвердить подпись (если требуется демо-окном; в макете может быть имитация).
4. Показать статус аутентификации в UI (компоненты AuthStatus/WalletInfo).

Что озвучить:

- Мы используем EIP-191 совместимую подпись, на бэкенде верификация secp256k1, выдаем JWT.
- Сессия будет использоваться во всех дальнейших шагах (без повторной авторизации).

Критерии успеха:

- Кнопка «Ethereum Wallet» стала «Connected»/статус авторизован.
- На фоне прошли два ключевых вызова: GET /auth/nonce, POST /auth/verify-wallet.

---

## Сцена 2. Навигация в «Мост» и базовый UI

Цель: показать удобство интерфейса и готовность формы к работе.

Шаги:

1. Перейти на вкладку Bridge (кнопка/таба «Swap» или URL /bridge).
2. Появились:
   - Поле Amount,
   - Селекторы токенов From/To,
   - Кнопка Review Swap / Get Quote (текст может отличаться в билде).

Критерии успеха:

- Поле Amount видно, кнопка сабмита присутствует.
- Комментарий: UI легкий, mobile-first, мгновенная валидация полей.

---

## Сцена 3. Живой квотинг и динамическая цена

Цель: показать, что система получает реальные квоты и курс формируется динамически.

Шаги:

1. Ввести сумму, например «0.01» (ETH).
2. Подождать 1–3 секунды.
3. Указать, что в фоне идут обращения к:
   - /api/v1/bridge/tokens — загрузка доступных токенов/сетей,
   - /api/v1/bridge/quote — расчет оптимального курса (1inch + Oracles).
4. Показать в UI появившуюся цену/квоту/оценку фи.

Критерии успеха:

- Нажатие «Get Quote/Review Swap» становится активным после валидного Amount.
- Логи/сеть в DevTools показывают вызовы /bridge/quote.

Зачем это зрителю:

- Демонстрирует продвинутое ценообразование и интеграцию 1inch Fusion+ без деталей реализации.

---

## Сцена 4. Переключение направления (ETH→NEAR и NEAR→ETH)

Цель: быстро показать двунаправочность моста.

Шаги:

1. Нажать кнопку смены направления (reverse/⇄).
2. Обратить внимание, что From/To переставились местами.
3. Коротко отметить: оба направления поддержаны (подтверждено E2E).

Критерии успеха:

- Видимое изменение порядка блоков цепочек/токенов.
- UI обновился без перезагрузки страницы.

---

## Сцена 5. Работа селекторов токенов

Цель: показать интерактивность и готовность UI к выбору токенов.

Шаги:

1. Клик по селектору токена «From».
2. Появляется dropdown/modal со списком токенов.
3. Выбрать другой токен или закрыть.
4. Повторить для «To».

Критерии успеха:

- Дропдаун открывается и закрывается стабильно.
- Выбор влияет на последующий квотинг.

---

## Сцена 6. AI Risk Analysis — онлайн-анализ риска

Цель: показать «ум» моста: оценка риска в реальном времени.

Шаги:

1. На странице Bridge ввести новую сумму, например «100» (для триггера анализа).
2. Подождать до 3 сек — в фоне выполняется POST /api/risk/analyze.
3. Появляются элементы RiskAnalysisDisplay:
   - Risk Score,
   - Уровень риска (низкий/средний/высокий),
   - Рекомендации/предупреждения.
4. Нажать «Показать детали риска» (toggle) — появляются факторы/аномалии/рекомендации.
5. Нажать «Обновить анализ» (refresh) — вызвать повторный анализ и увидеть новый запрос.

Критерии успеха:

- Видны UI-индикаторы риска, кнопки «Подробнее/Обновить» работают.
- В логах сети есть /api/risk/analyze до/после refresh.

Зачем это зрителю:

- Демонстрирует, что мост — «умный гейткипер» с governance-движком, а не просто форма.

---

## Сцена 7. High-Risk защита (смоделировано)

Цель: показать реакцию на высокий риск: предупреждение и блокировку действий.

Шаги:

1. Объяснить, что сейчас запущен демонстрационный высокорисковый сценарий.
2. Ввести большую сумму (например «10000»), дождаться анализа (имитация высокого риска).
3. Появляется High-Risk предупреждение в UI.
4. Кнопка Review/Submit становится неактивной (disabled) — операция заблокирована.

Критерии успеха:

- Ясный визуальный варнинг о высоком риске.
- Недоступность сабмита (блокировка до ручного review/снижения риска).

Зачем это зрителю:

- Безопасность по умолчанию. Риск — не «надпись», а реальный контроль выполнения.

---

## Сцена 8. Квантовая защита — статусы и индикаторы

Цель: подчеркнуть отличия KEMBridge: постквантовые алгоритмы и их прозрачное отображение.

Шаги:

1. На странице Bridge найти блок/бейдж «Quantum Protected» / «ML-KEM».
2. Показать SecurityIndicator/QuantumProtectionDisplay: статус «в норме».
3. Короткая реплика: «Мы используем ML-KEM-1024 + AES-GCM (гибридная схема). Это уже интегрировано в серверный SwapEngine».

Критерии успеха:

- Видны квантовые бейджи/статусы в UI.
- Сообщение краткое, без углубления в криптографию.

---

## Сцена 9. Обработка ошибок и устойчивость

Цель: показать, что продукт корректно отрабатывает ошибки и деградирует «грейсфулли».

Шаги:

1. Открыть /bridge без авторизации — увидеть «Auth required» сообщение.
2. Авторизоваться — сообщение исчезает, форма активна.
3. Ввести невалидные значения (abc, -1, 0, сверхбольшая сумма) — увидеть валидационные подсказки/ошибки.
4. Показать, что сеть ошибок (если возникают) отображается в UI уведомлениях/логах, а система сохраняет интерактивность.

Критерии успеха:

- Auth gate работает.
- Валидация данных активна и дружелюбна.
- Нет «падений» интерфейса при отклонениях.

---

## Сцена 10. Полный поток ETH→NEAR (демо без финального ончейн-исполнения)

Цель: показать весь жизненный цикл UI до шага подтверждения, не уходя в долгую блокчейн-часть.

Шаги:

1. Страница Bridge: авторизация уже есть.
2. Ввести сумму (например 0.01 ETH).
3. Дождаться квоты и нажать Review Swap (или Get Quote → Review).
4. Показать модалку с подтверждением: превью маршрута, фи, время.
5. Закрыть модалку, отметить: «Полное on-chain исполнение можно показать в записи/отдельной сессии, чтобы экономить время демо».

Критерии успеха:

- Модалка подтверждения появляется быстро и стабильно.
- Понятно, какие шаги будут далее при ончейн-исполнении (atomic swap, lock/mint/burn).

Зачем это зрителю:

- Понимание UX конца-до-конца без ожидания блокчейн-конфирмов на демо.

---

## Сцена 11. Real-time уведомления и WebSocket статус

Цель: продемонстрировать живую систему событий.

Шаги:

1. Обратить внимание на индикатор WebSocket (WebSocketStatus) — «подключено».
2. Показать RealTimeNotifications: всплывающие op/status/alerts (если доступны во время демо).
3. Короткая заметка: «При реальной операции статус обновляется живьем — без перезагрузок».

Критерии успеха:

- Видно, что WebSocket подключен.
- Хотя бы одно уведомление/индикатор статуса в реальном времени.

---

## Сцена 12. Бонус-быстрые кейсы (по времени)

Цель: дать пространство для «вау»-эффектов при наличии лишней минуты.

Варианты:

- Быстрая смена сетей/токенов с мгновенным пересчетом квоты.
- Ручной refresh AI-анализа и сравнение изменений (например, другой Amount).
- Демонстрация того, что при временной недоступности AI Engine UI не ломается, просто показывает «Loading/Offline» состояние, а форма остается функциональной в безопасном режиме.

---

# Приложение A. Карта соответствия шагов и тестов

- Web3 Auth + JWT: wallet-authentication.spec.js
- Health + Nonce API: api-integration.spec.js
- Bridge UI: bridge-integration.spec.js (UI элементы, навигация)
- Transaction Flow: transaction-flow.spec.js (amount, квоты, сабмит)
- Direction Switch и Token Selectors: transaction-flow.spec.js, bridge-integration.spec.js
- AI Risk UI: ai-risk-display.spec.js (presence, loading, high-risk, toggle, refresh)
- Security & Quantum Badges: security-risk-testing.spec.js

---

# Подготовка окружения (кратко)

1. Сервисы:
   - make dev
   - make health-quick (проверка)
2. Фронтенд:
   - pnpm run dev (порт 4100)
3. Тестовые кошельки:
   - Либо mock-режим, либо подготовленный demo-аккаунт.
4. План Б (видео):
   - Иметь короткий скринкаст финального on-chain шага.
